<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8" />
  <title>Emoji Shooter</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #000;
      overflow: hidden;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/2.6.2/phaser.min.js"></script>
  <script>
    var game = new Phaser.Game(window.innerWidth, window.innerHeight, Phaser.CANVAS, '', { preload: preload, create: create, update: update });

    var player;
    var bullets;
    var coins;
    var enemies;
    var enemyBig;
    var cursors;
    var fireRate = 100;
    var nextFire = 0;
    var score = 0;
    var scoreText;

    function preload() {
      game.stage.backgroundColor = '#000';
      game.load.image('fondo', 'https://twemoji.maxcdn.com/v/latest/72x72/1f304.png'); // üåÑ
      game.load.image('player', 'https://twemoji.maxcdn.com/v/latest/72x72/1f52b.png'); // üî´
      game.load.image('bullet', 'https://twemoji.maxcdn.com/v/latest/72x72/1f525.png'); // üî•
      game.load.image('coin', 'https://twemoji.maxcdn.com/v/latest/72x72/1fa99.png'); // ü™ô
      game.load.image('enemy', 'https://twemoji.maxcdn.com/v/latest/72x72/1f3af.png'); // üéØ
    }

    function create() {
      // Fondo
      var bg = game.add.tileSprite(0, 0, game.width, game.height, 'fondo');
      bg.width = game.width;
      bg.height = game.height;

      // Jugador
      player = game.add.sprite(game.world.centerX, game.world.height - 100, 'player');
      player.anchor.set(0.5);
      game.physics.arcade.enable(player);

      // Balas
      bullets = game.add.group();
      bullets.enableBody = true;
      bullets.physicsBodyType = Phaser.Physics.ARCADE;
      bullets.createMultiple(50, 'bullet');
      bullets.setAll('anchor.x', 0.5);
      bullets.setAll('anchor.y', 1);
      bullets.setAll('outOfBoundsKill', true);
      bullets.setAll('checkWorldBounds', true);

      // Monedas
      coins = game.add.group();
      coins.enableBody = true;
      for (var i = 0; i < 20; i++) {
        var coin = coins.create(game.world.randomX, game.world.randomY / 2, 'coin');
        coin.anchor.set(0.5);
      }

      // Enemigos peque√±os (destructibles)
      enemies = game.add.group();
      enemies.enableBody = true;
      for (var i = 0; i < 10; i++) {
        var enemy = enemies.create(game.world.randomX, game.world.randomY / 2, 'enemy');
        enemy.anchor.set(0.5);
        enemy.scale.setTo(0.6);
      }

      // Enemigo grande (indestructible)
      enemyBig = game.add.sprite(game.world.randomX, 100, 'enemy');
      enemyBig.anchor.set(0.5);
      enemyBig.scale.setTo(1.5);
      game.physics.arcade.enable(enemyBig);

      // Input
      cursors = game.input.keyboard.createCursorKeys();

      // Texto
      scoreText = game.add.text(20, 20, 'ü™ô 0 / 50', { font: '24px Arial', fill: '#fff' });
    }

    function update() {
      // Movimiento
      if (cursors.left.isDown) {
        player.x -= 5;
      } else if (cursors.right.isDown) {
        player.x += 5;
      }
      if (cursors.up.isDown) {
        player.y -= 5;
      } else if (cursors.down.isDown) {
        player.y += 5;
      }

      // Disparo continuo
      if (game.time.now > nextFire) {
        var bullet = bullets.getFirstExists(false);
        if (bullet) {
          bullet.reset(player.x, player.y);
          bullet.body.velocity.y = -400;
          nextFire = game.time.now + fireRate;
        }
      }

      // Colisiones
      game.physics.arcade.overlap(bullets, enemies, destroyEnemy, null, this);
      game.physics.arcade.overlap(player, coins, collectCoin, null, this);
      game.physics.arcade.overlap(player, enemyBig, hitBigEnemy, null, this);
    }

    function destroyEnemy(bullet, enemy) {
      bullet.kill();
      enemy.kill();
    }

    function collectCoin(player, coin) {
      coin.kill();
      score++;
      scoreText.text = 'ü™ô ' + score + ' / 50';
    }

    function hitBigEnemy() {
      // Aqu√≠ puedes hacer que pierda vida si se implementa sistema de corazones ‚ô¶Ô∏è‚ô•Ô∏è‚ô£Ô∏è‚ô†Ô∏è
      alert('¬°Has chocado con un enemigo gigante!');
      game.state.restart();
    }
  </script>
</body>
</html>
