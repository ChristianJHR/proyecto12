<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8" />
  <title>Emoji Shooter</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #000;
      overflow: hidden;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/2.6.2/phaser.min.js"></script>
  <script>
    var game = new Phaser.Game(window.innerWidth, window.innerHeight, Phaser.CANVAS, '', { preload: preload, create: create, update: update });

    var player;
    var bullets;
    var coins;
    var enemies;
    var enemyBig;
    var cursors;
    var fireRate = 100;
    var nextFire = 0;
    var score = 0;
    var scoreText;

    function preload() {
      game.stage.backgroundColor = '#000';
    }

    function create() {
      // Fondo gigante ðŸŒ„ como texto
      var bgText = game.add.text(game.world.centerX, game.world.centerY, 'ðŸŒ„', {
        font: (game.height) + 'px Arial',
        fill: '#fff'
      });
      bgText.anchor.set(0.5);

      // Jugador ðŸ”«
      player = game.add.text(game.world.centerX, game.world.height - 100, 'ðŸ”«', {
        font: '64px Arial', fill: '#fff'
      });
      player.anchor.set(0.5);
      game.physics.arcade.enable(player);

      // Balas ðŸ”¥
      bullets = game.add.group();
      bullets.enableBody = true;
      bullets.physicsBodyType = Phaser.Physics.ARCADE;
      for (var i = 0; i < 50; i++) {
        var bullet = game.add.text(0, 0, 'ðŸ”¥', { font: '32px Arial', fill: '#fff' });
        game.physics.arcade.enable(bullet);
        bullet.anchor.set(0.5);
        bullet.kill();
        bullets.add(bullet);
      }

      // Monedas ðŸª™ (menos cantidad para dificultad)
      coins = game.add.group();
      coins.enableBody = true;
      for (var i = 0; i < 20; i++) {
        var coin = game.add.text(game.world.randomX, game.world.randomY / 2, 'ðŸª™', {
          font: '32px Arial', fill: '#fff'
        });
        coin.anchor.set(0.5);
        game.physics.arcade.enable(coin);
        coins.add(coin);
      }

      // Enemigos pequeÃ±os ðŸŽ¯ destructibles
      enemies = game.add.group();
      enemies.enableBody = true;
      for (var i = 0; i < 6; i++) {
        var enemy = game.add.text(game.world.randomX, game.world.randomY / 2, 'ðŸŽ¯', {
          font: '36px Arial', fill: '#fff'
        });
        enemy.anchor.set(0.5);
        game.physics.arcade.enable(enemy);
        enemies.add(enemy);
      }

      // Enemigo grande ðŸŽ¯ (indestructible)
      enemyBig = game.add.text(game.world.randomX, 100, 'ðŸŽ¯', {
        font: '96px Arial', fill: '#fff'
      });
      enemyBig.anchor.set(0.5);
      game.physics.arcade.enable(enemyBig);

      // Input
      cursors = game.input.keyboard.createCursorKeys();

      // Texto puntuaciÃ³n
      scoreText = game.add.text(20, 20, 'ðŸª™ 0 / 50', { font: '24px Arial', fill: '#fff' });
    }

    function update() {
      // Movimiento
      if (cursors.left.isDown) {
        player.x -= 5;
      } else if (cursors.right.isDown) {
        player.x += 5;
      }
      if (cursors.up.isDown) {
        player.y -= 5;
      } else if (cursors.down.isDown) {
        player.y += 5;
      }

      // Disparo continuo ðŸ”¥
      if (game.time.now > nextFire) {
        var bullet = bullets.getFirstDead();
        if (bullet) {
          bullet.reset(player.x, player.y);
          bullet.body.velocity.y = -400;
          nextFire = game.time.now + fireRate;
        }
      }

      // Colisiones
      game.physics.arcade.overlap(bullets, enemies, destroyEnemy, null, this);
      game.physics.arcade.overlap(player, coins, collectCoin, null, this);
      game.physics.arcade.overlap(player, enemyBig, hitBigEnemy, null, this);
    }

    function destroyEnemy(bullet, enemy) {
      bullet.kill();
      enemy.kill();
    }

    function collectCoin(player, coin) {
      coin.kill();
      score++;
      scoreText.text = 'ðŸª™ ' + score + ' / 50';
    }

    function hitBigEnemy() {
      alert('Â¡Has chocado con un enemigo gigante!');
      game.state.restart();
    }
  </script>
</body>
</html>
